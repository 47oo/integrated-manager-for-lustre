<link rel="stylesheet" type="text/css" href="{{STATIC_URL}}css/server_configuration.css"/>
<script type="text/javascript" src="{{STATIC_URL}}js/server_configuration.js"></script>
<script type='text/javascript'>
  var ServerView = function() {
    var initialized = false;
    function draw() {
      if (!initialized) {
        init();
        initialized = true;
      } else {
        $('#server_configuration').dataTable().fnDraw();
      }
    }

    function init() 
    {
      $('#server_configuration').dataTable( {
        bServerSide: true,
        bProcessing: true,
        bJQueryUI: true,
        bAutoWidth:false,
        bFilter: false,
        sAjaxSource: 'host/',
        fnServerData: function(url, data, callback, settings) {
          Api.get_datatables(url, data, function(data) {
            //console.log(data);
            var processed_data = [];
            $.each(data.aaData, function(i, row) {
              row['label'] = LiveObject.label(row);
              row['state'] = LiveObject.state(row);
              row['actions'] = LiveObject.actions(row);
              row['icons'] = LiveObject.icons(row);
              if (!row['fqdn']) {
                row['fqdn'] = row['address'];
              }
              row['fqdn'] = object_properties_link(row, row['fqdn']);
            });
            callback(data);
          }, settings);
        },
        "oLanguage": {
            "sEmptyTable": "No Servers to display"
        },
        aaSort: [[0, 'asc']],
        "aoColumns": [
          { "sClass": 'txtleft', mDataProp: 'fqdn', bSortable: true},
          { "sClass": 'txtcenter', mDataProp: 'state', bSortable: false},
          { "sClass": 'txtcenter', bSortable: false, mDataProp: 'actions'},
          { "sClass": 'txtcenter', bSortable: false, mDataProp: 'icons'}
        ]
      } );
      $('#btnAddNewHost').click(function()
      {
        add_host_dialog();
      });
    }
    return {draw:draw}
  }();
</script>

<h2 class='section_header'>Server configuration</h2>
<div class="buttonspacer"><span class="first-child">
  <button class='add' type="button" id="btnAddNewHost">Add Server</button>
  </span></span></div>
<table cellpadding="0" cellspacing="0" border="0" class="display" id="server_configuration" width="100%">
  <thead>
    <tr>
      <th width="85%">Hostname</th>
      <th width="13%">LNet state</th>
      <th width="1%"></th>
      <th width="1%"></th>
    </tr>
  </thead>
  <tbody id="server_configuration_content">
    <tr><td></td><td></td><td></td><td></td></tr>
  </tbody>
</table>

<script type="text/template" id="add_host_dialog_template">
    <div class="add_host_dialog">
        <div class='add_host_wizard'>
            <div class="add_host_prompt">
                <form style="margin-bottom:0px;">
                    <label style="margin-right: 6px;" for='add_host_address'>Hostname:</label><input style="width:100%;" type='entry'  class='add_host_address'/>
                    <div style="text-align: right;">
                        <a style="margin-top: 6px;" class="add_host_submit_button" type='submit'>Continue</a>
                    </div>
                </form>
            </div>
            <div class="add_host_loading">
                <img src='{{STATIC_URL}}/images/ajax-loader.gif'/>
                <span class='loading_placeholder'>Checking connectivity...</span>
            </div>
            <div class='add_host_confirm'>
                <p style="margin-bottom: 0px;margin-top:0px;">Host: <span style="font-weight: bold;" class="add_host_address_label"></span></p>
                <table style="margin-bottom: 6px;">
                    <tr><td>Resolve: </td>     <td class="add_host_resolve">&nbsp;</td></tr>
                    <tr><td>Ping: </td>        <td class="add_host_ping">&nbsp;</td></tr>
                    <tr><td>Invoke agent: </td><td class="add_host_agent">&nbsp;</td></tr>
                    <tr><td>Reverse resolve: </td><td class="add_host_reverse_resolve">&nbsp;</td></tr>
                    <tr><td>Reverse ping: </td><td class="add_host_reverse_ping">&nbsp;</td></tr>
                </table>
                <a href="#" class="add_host_back_button">Back</a>
                <a href="#" class="add_host_confirm_button">Confirm</a>
            </div>
            <div class='add_host_complete'>
                <p>Host added.</p>
                <a href='#' class="add_host_close_button">Close</a>
                <a href='#' class="add_host_back_button">Add another</a>
            </div>
        </div>
    </div>
</script>
